@model IEnumerable<dynamic>

@{
    ViewData["Title"] = "Quản lý bài viết";
}

<h2 class="text-primary mb-4">Quản lý bài viết</h2>

<!-- ✅ Thông báo thành công -->
@if (TempData["SuccessMessage"] != null)

{
    <div id="alertMessage" class="alert alert-success alert-dismissible fade show" role="alert">
        @TempData["SuccessMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Đóng"></button>
    </div>
}
<!-- ❌ Thông báo lỗi -->
@if (TempData["ErrorMessage"] != null)

{
    <div id="alertMessage" class="alert alert-danger alert-dismissible fade show" role="alert">
        @TempData["ErrorMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Đóng"></button>
    </div>
}

<!-- Nút tạo mới -->
<a class="btn btn-success mb-4" asp-controller="Staff" asp-action="CreateNewsArticle">+ Thêm bài viết</a>

<!-- Bảng dữ liệu -->
<table class="table table-hover table-bordered shadow-sm">
    <thead class="table-dark text-center">
        <tr>
            <th>Tiêu đề</th>
            <th>Tiêu điểm</th>
            <th>Chuyên mục</th>
            <th>Người tạo</th>
            <th>Người cập nhật</th>
            <th>Ngày chỉnh sửa</th>
            <th>Trạng thái</th>
            <th>Thao tác</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var article in Model)

        {
            <tr>
                <td>@article.NewsTitle</td>
                <td>@article.Headline</td>
                <td>@article.CategoryName</td>
                <td>@article.CreatedByName</td>
                <td>@article.UpdatedByName</td>
                <td>@article.ModifiedDate?.ToString("dd/MM/yyyy")</td>
                <td class="text-center">
                    @if (article.NewsStatus == true)
                    {
                        <span class="badge bg-success">Đã duyệt</span>
                    }
                    else
                    {
                        <span class="badge bg-warning text-dark">Chờ duyệt</span>
                    }
                </td>
                <td class="text-center">
                    <div class="d-flex flex-wrap gap-1 justify-content-center">
                        <!-- Xem -->
                        <a class="btn btn-info btn-sm" asp-controller="Staff" asp-action="ViewNewsArticle" asp-route-id="@article.NewsArticleId">Xem</a>

                        <!-- Sửa -->
                        <a class="btn btn-warning btn-sm" asp-controller="Staff" asp-action="EditNewsArticle" asp-route-id="@article.NewsArticleId">Sửa</a>

                        <!-- Xoá -->
                        <form asp-controller="Staff" asp-action="DeleteNewsArticle" asp-route-id="@article.NewsArticleId" method="post" class="d-inline">
                            <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Bạn có chắc muốn xóa bài viết này không?');">Xoá</button>
                        </form>
                    </div>
                </td>
            </tr>
        }
    </tbody>
</table>

@section Scripts {
    <script>
        setTimeout(function () {
            var alertBox = document.getElementById('alertMessage');
            if (alertBox) {
                alertBox.style.transition = "opacity 0.5s ease-out";
                alertBox.style.opacity = "0";
                setTimeout(() => alertBox.style.display = "none", 500);
            }
        }, 5000);
    </script>
}
